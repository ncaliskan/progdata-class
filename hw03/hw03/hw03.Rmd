# Homework 03

You will analyze data looking at the relationship between **green reputation** and three personality traits--**compassion**, **intellectual curiosity**, and **openness to experiences**.
The dataset includes data from **students** and **non-students**.


```{r}
library(tidyverse)
library(ggplot2)
```

```{r}
dictionary <- readr::read_csv(("green_dictionary.csv"))
green_data <- readr::read_csv(("green_data.csv"))
```

For your assignment, do the following.

  1. Inspect the item responses (e.g., with graphs or by summarizing distinct values). 
     Is anything unusual?

Get the summaries of each data file     
```{r}
dictionary %>%
  summarize(dictionary)

#getting rid of the -99 values

green_data_new <- green_data %>%
                na_if("-99")


reversed <- dictionary %>%
  filter(Keying == -1) %>%
  pull(Item)

green_datar <- green_data_new %>% 
  mutate(across(all_of(reversed),
                ~ recode(.x, "1"= 5,"2" = 4,"4" = 2,"5"= 1 ),
                .names = "{.col}r"))

green_data_new$student <- recode_factor(green_data_new$student, '1' = "Non-student", '2' = "Student", .default = NULL)


#There are -99 s in the data file that needs to be recoded
```
     
  2. Compute total scores for the four scales. 
     Recode variables as needed.
```{r}
green_datar %>% 
  rowwise() %>% 
  mutate(green_tot = sum(c_across(green1:green5), na.rm = TRUE),
         comp_tot = sum(c_across(comp1:comp10r), na.rm = TRUE),
         intel_tot = sum(c_across(intel1:intel10r), na.rm = TRUE),
         open_tot = sum(c_across(open1:open10r), na.rm = TRUE))
```
    
  3. Rescale the variables so that they go from 0-100 instead of the original range.
     Name the recaled variables `*_pomp`.
```{r}
green_data_pomp <- green_datar %>% 
  mutate(across(c(green1:open10),
         ~ recode(.x, "1"= 0,"2" = 25, "3" = 50, "4" = 75,"5"= 100),
                .names = "{.col}_pomp"))

print(green_data_pomp)

Av_green_data_pomp <- green_data_pomp %>% 
  rowwise() %>% 
  mutate(green_mean_pomp = mean(c_across(green1:green5), na.rm = TRUE),
         comp_mean_pomp = mean(c_across(comp1:comp10r), na.rm = TRUE),
         intel_mean_pomp = mean(c_across(intel1:intel10r), na.rm = TRUE),
         open_mean_pomp = mean(c_across(open1:open10r), na.rm = TRUE))

```
     
  4. Make plots that illustrate the distributions of the 4 POMP-scored variables.
```{r}
Av_green_data_pomp %>% 
ggplot() +
  aes(comp_av_pomp,green_av_pomp) +
  geom_smooth(method = lm) 

Av_green_data_pomp %>% 
ggplot() +
  aes(comp_av_pomp,intel_av_pomp) +
  geom_smooth() 

Av_green_data_pomp %>% 
ggplot() +
  aes(comp_av_pomp,open_tav_pomp) +
  geom_smooth() 

Av_green_data_pomp %>% 
ggplot() +
  aes(open_tav_pomp,intel_av_pomp) +
  geom_smooth() 


Av_green_data_pomp %>% 
ggplot() +
aes(x = green_av_pomp) +
  geom_histogram(fill = "orange") +
  theme_classic()

Av_green_data_pomp %>% 
ggplot() +
aes(x = comp_av_pomp) +
  geom_histogram(fill = "pink") +
  theme_classic()

Av_green_data_pomp %>% 
ggplot() +
aes(x = intel_av_pomp) +
  geom_histogram(bins = 50, fill = "purple") +
  theme_classic()

Av_green_data_pomp %>% 
ggplot() +
aes(x = open_tav_pomp) +
  geom_histogram(bins = 50, fill = "yellow") +
  theme_classic()


```
  
  5. Make scatterplots showing the relationships between **green reputation** and each personality trait.
     Include trend lines for **students** and **non-students**.
     What do these plots show?
     
```{r}
Av_green_data_pomp %>% 
  ggplot(is.na(student)) +
  aes(green_av_pomp, comp_av_pomp)
  geom_point(alpha = 0.5) 
  
Av_green_data_pomp %>% 
  ggplot(na.rm = TRUE) +
  aes(green_av_pomp, intel_av_pomp)
  geom_point(alpha = 0.5) 
  
```
     
  6. Compare **green reputation** for students and non-students using a **rainfall plot** (bar + density + data points).
  7. Compute a summary table of means, SDs, medians, minima, and maxima for the four total scores for students and non-students.
  
In your assignment, prepare an RMarkdown file that includes both the coding and (for 4-7) narrative descriptions of your results.



